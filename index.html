<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynami Instrumentpanel - Live</title>
<style>
    body {
        font-family: 'Helvetica Neue', Arial, sans-serif;
        margin: 0;
        color: #333;
        display: flex;
        height: 100vh;
        background: linear-gradient(to bottom, #ffaf4b, #ff8c00);
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .container {
        display: flex;
        width: 100%;
        background-color: rgba(255, 255, 255, 0.9);
        margin: 20px;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .left-panel {
        background-color: #ffffff;
        padding: 40px;
        width: 35%; /* Updated width */
        box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        border-right: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        max-height: 100%;
        box-sizing: border-box;
    }

    .right-panel {
        padding: 40px;
        width: 65%; /* Adjusted width */
        display: flex;
        flex-direction: column;
        color: #333;
    }

    h1 {
        font-size: 48px;
        color: #e65100;
        margin-top: 0;
        margin-bottom: 20px;
        text-align: center;
        flex-shrink: 0;
    }

    #service-list-container {
        flex-grow: 1;
        overflow-y: auto;
        min-height: 0;
        padding-right: 15px;
    }

    .checklist-item {
        margin-bottom: 25px;
        display: flex;
        align-items: center;
    }

    .checklist-item input[type="checkbox"] {
        display: none;
    }

    .checklist-item label {
        position: relative;
        padding-left: 45px;
        cursor: pointer;
        font-size: 22px; /* Initial font size */
    }

    .checklist-item label:before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 28px;
        height: 28px;
        border: 3px solid #ff8c00;
        border-radius: 5px;
        background-color: #fff;
    }

    .checklist-item input[type="checkbox"]:checked + label:after {
        content: '';
        position: absolute;
        left: 10px;
        top: 5px;
        width: 8px;
        height: 16px;
        border: solid #e65100;
        border-width: 0 4px 4px 0;
        transform: rotate(45deg);
    }

    #clock {
        font-size: 84px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 5px;
    }

    #date {
        font-size: 32px;
        text-align: center;
        margin-bottom: 30px;
    }

    .logo-container {
        flex-grow: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 0;
    }

    .logo-container img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }

</style>
</head>
<body>

<div class="container">
    <div class="left-panel">
        <h1>Servicelista</h1>
        <div id="service-list-container">
            <!-- Dynamically populated -->
        </div>
    </div>
    <div class="right-panel">
        <div id="clock"></div>
        <div id="date"></div>
        <div class="logo-container">
            <img src="Dynami_10a╠èr_OK.png" alt="Dynami 10 år Logotyp">
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

<script>
    function updateTime() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;

        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('date').textContent = now.toLocaleDateString('sv-SE', options);
    }
    setInterval(updateTime, 1000);
    updateTime();

    const firebaseConfig = {
      apiKey: "AIzaSyDrkXax4XtQdC_kGIVN1OgleLKIunOrIcM",
      authDomain: "erikdynami.firebaseapp.com",
      projectId: "erikdynami",
      storageBucket: "erikdynami.firebasestorage.app",
      messagingSenderId: "1014648797947",
      appId: "1:1014648797947:web:323c4dc9bc3ad6ef288e5e"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const tasksRef = database.ref('tasks');
    const listContainer = document.getElementById('service-list-container');

    tasksRef.on('value', (snapshot) => {
        const tasks = snapshot.val();
        listContainer.innerHTML = ''; 

        if (tasks) {
            Object.keys(tasks).forEach(key => {
                const taskData = tasks[key];
                createTaskElement(key, taskData);
            });
        } else {
            listContainer.innerHTML = '<p>Inga uppgifter att visa.</p>';
        }
        adjustFontSize(); // Adjust font size after list is populated
    });

    function createTaskElement(key, taskData) {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'checklist-item';
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = key;
        checkbox.checked = taskData.completed;

        const label = document.createElement('label');
        label.htmlFor = key;
        label.textContent = taskData.text;

        checkbox.addEventListener('change', (event) => {
            const isChecked = event.target.checked;
            database.ref('tasks/' + key).update({
                completed: isChecked
            });
        });

        itemDiv.appendChild(checkbox);
        itemDiv.appendChild(label);
        listContainer.appendChild(itemDiv);
    }

    /**
     * Adjusts the font size of the checklist items to fit within the container.
     */
    function adjustFontSize() {
        // Disable overflow-y to check if content overflows
        listContainer.style.overflowY = 'hidden';
        const labels = listContainer.querySelectorAll('.checklist-item label');
        if (labels.length === 0) return;

        let currentFontSize = parseFloat(window.getComputedStyle(labels[0]).fontSize);
        const minFontSize = 10; // Minimum font size

        // Reduce font size until content fits
        while (listContainer.scrollHeight > listContainer.clientHeight && currentFontSize > minFontSize) {
            currentFontSize--;
            labels.forEach(label => {
                label.style.fontSize = `${currentFontSize}px`;
            });
        }
        // Restore overflow-y
        listContainer.style.overflowY = 'auto';
    }
</script>

</body>
</html>
